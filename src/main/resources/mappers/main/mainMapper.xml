<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ade.portfolio.main.mapper.MainMapper">

    <select id="selectEstm" parameterType="com.ade.portfolio.main.model.MainVO" resultType="com.ade.portfolio.main.model.MainVO">
        SELECT  BASE_DATE                   AS baseDate
        ,       TOT_BUY_AMT                 AS totBuyAmt
        ,       TOT_EST_AMT                 AS totEstAmt
        ,       NVL(FUNC_GET_EXRT(TO_CHAR(SYSDATE, 'YYYYMMDD'), 'USD', 1), 0)    AS exrtRate
        ,       FUNC_RN(YIELD , 3) * 100    AS yield
        FROM    ADESTM
        WHERE   BASE_DATE = (SELECT MAX(EE.BASE_DATE) FROM ADESTM EE)
    </select>

</mapper>
